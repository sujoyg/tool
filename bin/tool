#!/usr/bin/env ruby

$script = File.basename(__FILE__)

require "optparse"
require File.expand_path("../../lib/tool", __FILE__)
require File.expand_path("../../lib/constants", __FILE__)


def main
  config_file = File.join ENV["HOME"], ".tool", "config.yml"
  constants = File.exists?(config_file) ? Tool::Constant.read(config_file) : Tool::Constant.new
  begin
    first_arg = (ARGV.size > 0 ? ARGV[0] : nil)

    output = case first_arg
      when "aws" then
        AWS.new(constants).aws(ARGV[1..-1])
      else
        puts "Usage:"
        puts "\t#{$script} aws ..."
    end
    puts output if output
  rescue UserError => e
    puts e
  rescue => e
    raise
  end
end


if __FILE__ == $0
  main
end
